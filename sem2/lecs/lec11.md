# Рефакторинг и оптимизация кода

## Определение

Рефакторинг - процесс переработки исходного кода с целью сделает его более простым и понятным.

Рефакторинг не меняет смысла программы, не исправляет ошибки и не добавляет новую функциональность. Он делает код более понятным и читаемым.

Оптимизация - процесс переработки исходного кода с целью улучшения его производительности.

## Разница между рефакторингом и оптимизацией

Рефакторинг — не оптимизация, хотя и может быть с нею связан. Часто его проводят одновременно с оптимизацией, поэтому понятия кажутся синонимами. Но у этих процессов разные цели.

Цель оптимизации — улучшение производительности программы, а рефакторинга — улучшение понятности кода. После оптимизации исходный код может стать сложнее для понимания.

## Типы рефакторинга

### Дублирование

Наличие одного и того же кода в разных частях команды усложнает поддержку кода и уменьшает его понятность.

Решение: вынести дублированный код в отдельую функцию или класс.

### Длинные функции или классы

Оптимальный размер этих элементов 20-30 строк. Если получается больше, разделите функцию на несколько маленьких и добавьте одну общую. Пусть маленькие выполняют по одной операции, а общая функция их вызывает.

### Сложный код

Избытачно реализованная логика, которую можно описать проще и понятнее.

```python
result = [x for x in range(100) if all(x % y != 0 for y in range(2, int(x ** 0.5) + 1))]
```

```python
numbers = [1, 2, 3, 4, 5]
total = sum(numbers)

## ИЛИ

class NumberList:
    def __init__(self):
        self.numbers = []

    def add_number(self, number):
        self.numbers.append(number)

    def calculate_sum(self):
        return sum(self.numbers)

numbers = [1, 2, 3, 4, 5]
number_list = NumberList()
for number in numbers:
    number_list.add_number(number)
total = number_list.calculate_sum()
```
### Избыточная абстракция

Иногда программисты могут стараться сделать код слишком абстрактным, чтобы улучшить его переиспользуемость. Это может привести к избыточной сложности и трудностям при поддержке кода.

```python
class Animal:
    def __init__(self, name, species):
        self.name = name
        self.species = species
    
    def speak(self):
        raise NotImplementedError

class Dog(Animal):
    def __init__(self, name):
        super().__init__(name, 'dog')
    
    def speak(self):
        return 'Woof!'

class Cat(Animal):
    def __init__(self, name):
        super().__init__(name, 'cat')
    
    def speak(self):
        return 'Meow!'

def speak(animal):
    print(animal.speak())

dog = Dog('Fido')
cat = Cat('Fluffy')

speak(dog)
speak(cat)

## ИЛИ

def dog_speak():
    print('Woof!')

def cat_speak():
    print('Meow!')

dog_speak()
cat_speak()
```

### Мертвый код

Переменная, параметр, метод или класс больше не используются: требования к программе изменились, но код не почистили. Мёртвый код может встретиться и в сложной условной конструкции, где какая-то ветка никогда не исполняется из-за ошибки или изменения требований. Такие элементы или участки текста нужно удалить.

### Имена переменных, функций или классов не передают их назначение

Имена должны сообщать, почему элемент кода существует, что он делает и как используется. Если видите, что намерения программиста непонятны без комментария, — рефакторьте. 

### Слишком длинный список параметров функции или метода

Они только запутывают, а не помогают. Если все эти параметры действительно нужны, вынесите их в отдельную структуру или класс с понятным именем, а в функцию передайте ссылку на него.

### Много комментариев

Плохой код часто прикрывается обильными комментариями. Если почувствовали желание пояснить какой-то участок кода, попробуйте сначала его переписать, чтобы и так стал понятным. Бесполезные комментарии загромождают программу, а устаревшие и неактуальные вводят в заблуждение.
